"use strict";function init(){scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(45,windowWidth/windowHeight,.1,1e3),camera.position.set(100,100,100),scene.add(camera),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setSize(windowWidth,windowHeight),container=document.getElementById("lamab"),container.appendChild(renderer.domElement);var e=new THREE.PointLight(16777215);e.position.set(100,100,100),scene.add(e);var n="images/bg/",t=".jpg",o=[n+"test2x-xpos"+t,n+"test2x-xneg"+t,n+"test2x-ypos"+t,n+"test2x-yneg"+t,n+"test2x-zpos"+t,n+"test2x-zneg"+t],a=(new THREE.CubeTextureLoader).load(o);a.format=THREE.RGBFormat,a.mapping=THREE.CubeRefractionMapping;var i=new THREE.BoxGeometry(1024,1024,1024),r=THREE.ShaderLib.cube,c=new THREE.ShaderMaterial({fragmentShader:r.fragmentShader,vertexShader:r.vertexShader,uniforms:r.uniforms,depthWrite:!1,side:THREE.BackSide});c.uniforms.tCube.value=a;var s=new THREE.Mesh(i,c);scene.add(s);var m=30,d=512,u=512,l=document.createElement("canvas"),w=document.createElement("canvas"),g=document.createElement("canvas"),p=document.createElement("canvas"),E=document.createElement("canvas"),h=document.createElement("canvas");l.width=d,l.height=u,w.width=d,w.height=u,g.width=d,g.height=u,p.width=d,p.height=u,E.width=d,E.height=u,h.width=d,h.height=u;var b=l.getContext("2d"),y=w.getContext("2d"),v=g.getContext("2d"),R=p.getContext("2d"),f=E.getContext("2d"),H=h.getContext("2d"),M=new Image;M.crossOrigin="anonymous",M.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",M.onload=function(){b.drawImage(M,0,0)};var T=new Image;T.crossOrigin="anonymous",T.src="http://ericmotil.com/la-mab/images/cubeFace2.svg",T.onload=function(){y.drawImage(T,0,0)};var x=new Image;x.crossOrigin="anonymous",x.src="http://ericmotil.com/la-mab/images/cubeFace3.svg",x.onload=function(){v.drawImage(x,0,0)};var k=new Image;k.crossOrigin="anonymous",k.src="http://ericmotil.com/la-mab/images/cubeFace4.svg",k.onload=function(){R.drawImage(k,0,0)};var Y=new Image;Y.crossOrigin="anonymous",Y.src="http://ericmotil.com/la-mab/images/cubeFace5.svg",Y.onload=function(){f.drawImage(Y,0,0)};var D=new Image;D.crossOrigin="anonymous",D.src="http://ericmotil.com/la-mab/images/cubeFace6.svg",D.onload=function(){H.drawImage(D,0,0)};var L=new THREE.MeshBasicMaterial({map:new THREE.Texture(l),transparent:!0});L.map.needsUpdate=!0;var O=new THREE.MeshBasicMaterial({map:new THREE.Texture(w),transparent:!0});O.map.needsUpdate=!0;var C=new THREE.MeshBasicMaterial({map:new THREE.Texture(g),transparent:!0});C.map.needsUpdate=!0;var X=new THREE.MeshBasicMaterial({map:new THREE.Texture(p),transparent:!0});X.map.needsUpdate=!0;var I=new THREE.MeshBasicMaterial({map:new THREE.Texture(E),transparent:!0});I.map.needsUpdate=!0;var B=new THREE.MeshBasicMaterial({map:new THREE.Texture(h),transparent:!0});B.map.needsUpdate=!0;var W=new THREE.CubeGeometry(m+1,m+1,m+1),F=[L,O,C,X,I,B],S=new THREE.MultiMaterial(F);cubeLink=new THREE.Mesh(W,S),scene.add(cubeLink),cubeLink.position.set(0,0,0),cubeLink.doubleSided=!0;var z=new THREE.BoxGeometry(m,m,m),_=new THREE.MeshBasicMaterial({color:16777215,wireframe:!1,envMap:a,refractionRatio:.9});cube=new THREE.Mesh(z,_),cube.position.set(0,0,0),scene.add(cube),raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,window.addEventListener("resize",onWindowResize,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function raycastFaces(){raycaster.setFromCamera(mouse,camera);var e=raycaster.intersectObject(cubeLink);if(e.length>0){var n=e[0].face.materialIndex;switch(n){case 0:console.log("face 1"),window.open("http://twitter.com","_blank","","");break;case 1:console.log("face 2"),window.open("http://facebook.com","_blank","","");break;case 2:console.log("face 3"),window.open("http://instagram.com","_blank","","");break;case 3:console.log("face 4"),window.open("http://tumblr.com","_blank","","");break;case 4:console.log("face 5"),window.open("http://music.com","_blank","","");break;case 5:console.log("face 6"),window.open("http://shirts.com","_blank","","");break;default:event.preventDefault()}}}function onDocumentMouseDown(e){e.preventDefault(),mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=2*-(e.clientY/renderer.domElement.clientHeight)+1,raycastFaces(),mouseXOnMouseDown=e.clientX-windowHalfX,console.log("mouse x = "+mouseXOnMouseDown),console.log("target rotation = "+targetRotationOnMouseDown),mouseYOnMouseDown=e.clientY-windowHalfY,targetRotationOnMouseDown=targetRotation,targetRotationYOnMouseDown=targetRotationY}function onDocumentMouseMove(e){mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=2*-(e.clientY/renderer.domElement.clientHeight)+1,raycaster.setFromCamera(mouse,camera);var n=raycaster.intersectObject(cubeLink);n.length>0?document.body.style.cursor="pointer":document.body.style.cursor="move",mouseCameraX=.05*(e.clientX-windowHalfX),mouseCameraY=.05*(e.clientY-windowHalfY),mouseX=.05*(e.clientX-windowHalfX),mouseY=.05*(e.clientY-windowHalfY),targetRotation=targetRotationOnMouseDown+.02*(mouseX-mouseXOnMouseDown),targetRotationY=targetRotationYOnMouseDown+.02*(mouseY-mouseYOnMouseDown)}function onDocumentTouchStart(e){mouse.x=2*+(e.touches[0].pageX/window.innerWidth)+-1,mouse.y=2*-(e.touches[0].pageY/window.innerHeight)+1,raycastFaces()}function onDocumentTouchMove(e){1===e.touches.length&&e.preventDefault()}function animate(){requestAnimationFrame(animate),render()}function render(){renderer.render(scene,camera),camera.position.x+=.015*(mouseCameraX-camera.position.x),camera.position.y+=.015*(-mouseCameraY-camera.position.y),cube.rotation.x+=.015,cube.rotation.y+=.015,cubeLink.rotation.x+=.015,cubeLink.rotation.y+=.015,cube.rotation.y+=.005*(targetRotationY-cube.rotation.y),cube.rotation.x+=.005*(targetRotation-cube.rotation.x),cubeLink.rotation.y+=.005*(targetRotationY-cubeLink.rotation.y),cubeLink.rotation.x+=.005*(targetRotation-cubeLink.rotation.x)}function initAudioPlayer(){function e(){audio.paused?(audio.play(),playbtn.style.background="url(http://ericmotil.com/la-mab/images/pause-button.png) no-repeat"):(audio.pause(),playbtn.style.background="url(http://ericmotil.com/la-mab/images/play-button.png) no-repeat")}audio=new Audio,audio.src="audio/gone.mp3",audio.loop=!0,audio.play(),playbtn=document.getElementById("playpausebtn"),mutebtn=document.getElementById("mutebtn"),playbtn.addEventListener("click",e)}var container,scene,camera,renderer,controls,stats,cube,cubeLink,raycaster,mouse,mouseCameraX=0,mouseCameraY=0,windowWidth=window.innerWidth,windowHeight=window.innerHeight,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,targetRotation=0,targetRotationOnMouseDown=0,targetRotationY=0,targetRotationYOnMouseDown=0,mouseX=0,mouseY=0,mouseXOnMouseDown=0,mouseYOnMouseDown=0;init(),animate();var modal=document.getElementById("myModal"),btn=document.getElementById("btn-overlay"),span=document.getElementsByClassName("close")[0];btn.onclick=function(){modal.style.display="block"},span.onclick=function(){modal.style.display="none"},modal.onclick=function(){modal.style.display="none"},window.onclick=function(e){e.target==modal&&(modal.style.display="none")};var audio,playbtn,mutebtn,seek_bar;window.addEventListener("load",initAudioPlayer);