"use strict";function init(){scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(45,windowWidth/windowHeight,.1,1e3),camera.position.set(100,100,100),scene.add(camera),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setSize(windowWidth,windowHeight),container=document.getElementById("lamab"),container.appendChild(renderer.domElement);var e=new THREE.PointLight(16777215);e.position.set(0,500,0),scene.add(e);var n="http://ericmotil.com/la-mab/images/bg/",o=".jpg",t=[n+"xpos"+o,n+"xneg"+o,n+"ypos"+o,n+"yneg"+o,n+"zpos"+o,n+"zneg"+o],a=new Image;a.crossOrigin="anonymous",a.src="images/cubeFace1.png";var i=(new THREE.CubeTextureLoader).load(t);i.format=THREE.RGBFormat,i.mapping=THREE.CubeRefractionMapping;var r=new THREE.BoxGeometry(1e3,1e3,1e3),c=THREE.ShaderLib.cube,s=new THREE.ShaderMaterial({fragmentShader:c.fragmentShader,vertexShader:c.vertexShader,uniforms:c.uniforms,depthWrite:!1,side:THREE.BackSide});s.uniforms.tCube.value=i;var u=new THREE.Mesh(r,s);scene.add(u);var m=25,d=512,w=512,g=document.createElement("canvas"),l=document.createElement("canvas"),E=document.createElement("canvas"),h=document.createElement("canvas"),p=document.createElement("canvas"),v=document.createElement("canvas");g.width=d,g.height=w,l.width=d,l.height=w,E.width=d,E.height=w,h.width=d,h.height=w,p.width=d,p.height=w,v.width=d,v.height=w;var b=g.getContext("2d"),R=l.getContext("2d"),M=E.getContext("2d"),H=h.getContext("2d"),f=p.getContext("2d"),T=v.getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",a.onload=function(){b.drawImage(a,0,0)};var D=new Image;D.crossOrigin="anonymous",D.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",D.onload=function(){R.drawImage(D,0,0)};var x=new Image;x.crossOrigin="anonymous",x.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",x.onload=function(){M.drawImage(x,0,0)};var Y=new Image;Y.crossOrigin="anonymous",Y.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",Y.onload=function(){H.drawImage(Y,0,0)};var y=new Image;y.crossOrigin="anonymous",y.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",y.onload=function(){f.drawImage(y,0,0)};var L=new Image;L.crossOrigin="anonymous",L.src="http://ericmotil.com/la-mab/images/cubeFace1.svg",L.onload=function(){T.drawImage(L,0,0)};var k=new THREE.MeshBasicMaterial({map:new THREE.Texture(g),transparent:!0});k.map.needsUpdate=!0;var O=new THREE.MeshBasicMaterial({map:new THREE.Texture(l),transparent:!0});O.map.needsUpdate=!0;var X=new THREE.MeshBasicMaterial({map:new THREE.Texture(E),transparent:!0});X.map.needsUpdate=!0;var I=new THREE.MeshBasicMaterial({map:new THREE.Texture(h),transparent:!0});I.map.needsUpdate=!0;var W=new THREE.MeshBasicMaterial({map:new THREE.Texture(p),transparent:!0});W.map.needsUpdate=!0;var C=new THREE.MeshBasicMaterial({map:new THREE.Texture(v),transparent:!0});C.map.needsUpdate=!0;var S=new THREE.CubeGeometry(m+1,m+1,m+1),B=[k,O,X,I,W,C],F=new THREE.MultiMaterial(B);cubeLink=new THREE.Mesh(S,F),scene.add(cubeLink),cubeLink.position.set(0,0,0),cubeLink.doubleSided=!0;var z=new THREE.BoxGeometry(m,m,m),U=new THREE.MeshBasicMaterial({color:16777215,wireframe:!1,envMap:i,refractionRatio:.85});cube=new THREE.Mesh(z,U),cube.position.set(0,0,0),scene.add(cube),raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,window.addEventListener("resize",onWindowResize,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("touchstart",onDocumentTouchStart,!1),document.addEventListener("touchmove",onDocumentTouchMove,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseDown(e){e.preventDefault(),mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=2*-(e.clientY/renderer.domElement.clientHeight)+1,raycaster.setFromCamera(mouse,camera);var n=raycaster.intersectObject(cubeLink);if(n.length>0){var o=n[0].face.materialIndex;switch(o){case 0:console.log("face 1"),window.open("http://google.com","_blank","","");break;case 1:console.log("face 2"),window.open("http://google.com","_blank","","");break;case 2:console.log("face 3"),window.open("http://google.com","_blank","","");break;case 3:console.log("face 4"),window.open("http://google.com","_blank","","");break;case 4:console.log("face 5"),window.open("http://google.com","_blank","","");break;case 5:console.log("face 6"),window.open("http://google.com","_blank","","");break;default:e.preventDefault()}}mouseXOnMouseDown=e.clientX-windowHalfX,mouseYOnMouseDown=e.clientY-windowHalfY}function onDocumentMouseMove(e){mouseX=.02*(e.clientX-windowHalfX),mouseY=.02*(e.clientY-windowHalfY),targetRotation=targetRotationOnMouseDown+.02*(mouseX-mouseXOnMouseDown),targetRotationY=targetRotationYOnMouseDown+.02*(mouseY-mouseYOnMouseDown)}function onDocumentMouseUp(e){document.removeEventListener("mouseup",onDocumentMouseUp,!1),document.removeEventListener("mouseout",onDocumentMouseOut,!1)}function onDocumentMouseOut(e){document.removeEventListener("mouseup",onDocumentMouseUp,!1),document.removeEventListener("mouseout",onDocumentMouseOut,!1)}function onDocumentTouchStart(e){e.preventDefault(),e.clientX=e.touches[0].clientX,e.clientY=e.touches[0].clientY,onDocumentMouseDown(e)}function onDocumentTouchMove(e){1===e.touches.length&&(e.preventDefault(),mouseX=.5*(e.touches[0].pageX-windowHalfX),mouseY=.5*(e.touches[0].pageY-windowHalfY),targetRotation=targetRotationOnMouseDown+.2*(mouseX-mouseXOnMouseDown),targetRotationY=targetRotationYOnMouseDown+.2*(mouseY-mouseYOnMouseDown))}function animate(){requestAnimationFrame(animate),render(),camera.position.x+=.02*(mouseX/2-camera.position.x),camera.position.y+=.02*(-mouseY/2-camera.position.y)}function render(){renderer.render(scene,camera),cube.rotation.x+=.05,cube.rotation.y+=.05,cubeLink.rotation.x+=.05,cubeLink.rotation.y+=.05,cube.rotation.y+=.005*(targetRotationY-cube.rotation.y),cube.rotation.x+=.005*(targetRotation-cube.rotation.x),cubeLink.rotation.y+=.005*(targetRotationY-cubeLink.rotation.y),cubeLink.rotation.x+=.005*(targetRotation-cubeLink.rotation.x)}var container,scene,camera,renderer,controls,stats,cube,cubeLink,raycaster,targetRotation=0,targetRotationOnMouseDown=0,targetRotationY=0,targetRotationYOnMouseDown=0,mouse,mouseX=0,mouseY=0,mouseXOnMouseDown=0,mouseYOnMouseDown=0,windowWidth=window.innerWidth,windowHeight=window.innerHeight,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;init(),animate(),window.addEventListener("resize",onWindowResize,!1);